# 编程部分

## JointQuant 教程

**聚宽sdk**



## 大数据(基础)

- 数字化能力
  - Git,markdown
  - Python
  - Pandas数据分析
- 数据管理
  - SQL
  - PostgreSQL数据库/Greenplum数据库
- 数据分析

### 一 Panda使用示例

#### 基本结构

1. series

2. dataframe

#### 统计操作

#### 文件读写

### 二 聚宽接口API

```python
get_price()
# 获取历史数据
get_fundamental()
# 获取基本面数据
```

### 三 数据系统

- 交易系统的支撑是数据系统
  - 数据来源多样，格式不一
  - 数据质量差异，数据清洗
  - 修正数据(前视偏差 look ahead)
- 交易数据
  - 价格数据
  - 基本面数据

### 四 数据管理系统

- 数据库形式
  - Flat File带索引的文件(专用)使用较少
  - 关系型数据库(RDBMS)(通用)
  - 数据立方(Data Cube)

- 关系型数据库
  - 统一的数据库管理语言：SQL
    - MySQL
    - PostgreSQL
    - SQLite
- 数据立方：将所有进入产品所有属性放在一个三维（更多维）数据表
  - 时间、地点、产品

# 投资部分

## 创建自己的交易策略

### 一 你交易的是你的观念——你的alpha从哪里来

- 量化投资策略的组合
  - 多因子模型
- 零投资组合检验

### 二 趋势跟随——海龟交易法

- 一个交易系统的要素
  - 市场：买卖什么？股票？期货？...
    - 一定：交易流动性好的品种(剔除流动在10亿以下的)
  - **头寸规模**：买卖多少？
    - 波动性N：$N=(19\times PDN+TR)/20$ 20天波动性的平均值
    - $PDN=前一日的N值$
    - $TR=当日的真实波动幅度$
    - $真实波动幅度 = Max(H-L,H-PDC,PDC-L)$
    - $H=当日最高价$
    - $L=当日最低价$
    - $PDC=前一日收盘价$
    - 头寸规模单位=账户的1%/(N*每一点数所代表的美元)
    - 账户的1%：能忍受的最大亏损
    - 每一点数所代表的美元>>>每一最小交易单位的资金(1手股票)
    - 风险与头寸单位：4个层面的限制，避免风险过于集中
      - 1：单个市场，头寸单位上限：4
      - 2：高度关联的多个市场（例如中国平安和中国人寿），6
      - 3：松散关联的多个市场（保险和钢铁），10
      - 4：单个方向（多头或空头），12
  - 入市：什么时候买卖？
    - 系统1：以20日突破为基础的短期系统（当前价格突破前20日最高价，做多；反之亦然）
      - （避免重复入场）如果上一次突破是一次盈利性突破，那么当前的入市信号被忽略
      - 55日突破点保障信号
    - 系统2：以55日突破为基础的长期系统
  - 逐步建仓
    - 在突破点建立1个单位的头寸
    - 按N/2的价格间隔逐步扩大头寸
    - 直到头寸达到规模上限
  - 止损：什么时候放弃一个亏损的头寸？
    - 止损标准：任何一笔交易的风险程度不超过账户的2%，价格变动的上限就是2N，对于加仓情况，止损点上浮。
  - 退出：什么时候退出一个盈利的头寸？
    - 系统1:10日反向突破退出
    - 系统2:20日反向突破退出
    - **克服提前退出的冲动，坦然面对利润的蒸发**
  - 应对复杂情况
    - 流动性瞬间枯竭(新冠肺炎)
    - 跳空(收盘还有持仓，特朗普发了个推特，大幅跳空低开)
    - 跨市场选择(怎么跨市场选择头寸？如何rebalance)
    - 合约滚动(合约到期了)
    - 为什么是20/10和55/20？
  - 战术：怎么买卖？
- 怎么评价一个系统？
  - 期望？
  - 胜率？
  - 风险调整收益-夏普比率？

### 三 均值回复——大部分时间里市场没有明显趋势

#### 1 趋势跟随与均值回复

- 市场在大多数时间是无效震荡
- 大的趋势只在少数时间内出现

![image-20200306152713078](C:\Users\段雨辰\AppData\Roaming\Typora\typora-user-images\image-20200306152713078.png)

微小尺度：随机游走

小尺度：均值回复

中尺度：趋势跟随+均值回复

大尺度：趋势+反转

#### 2 短期市场反转

- 建立一个股票池：
  - 过去3(或1)个月表现最差的N只股票构成的组合
  - 再平衡周期：
    - 1个月
  - 头寸管理：
    - 所有入选股票均仓
    - 按照市值加权
  - 也可做一个多空组合：
    - 做多表现最差组合
    - 做空表现最好的组(A股市场无法做空)

#### 3 长期市场反转

- 与短期反转的区别：时间

#### 4 优化的方向

震荡区间画的更准确、均值回复提高胜率

- 缺口方式
  - 选择“缺口型”股票：开盘瞬间，所有前一日最低价至今日开盘价之间的收益率低于一个标准差的区间(***今天低开了，低1个标准差以上***)。标准差定义为90天的日间收盘价的收益率的标准差。
  - 缩小范围：只保留当日开盘价高于收盘价20日移动平均线的股票(***选择上升阶段的股票，但是由于某些突发因素突然低开***)
  - 在剩余的股票中，按当日开盘价与前一日最低价相比得出的收益率由低到高排序，买入排名前10的股票，不足10支就都买入。(***买10支差的最多的***)
  - 收盘之前清算(***A股T+1怎么办？***)

#### 尺度量价

<img src="C:\Users\段雨辰\AppData\Roaming\Typora\typora-user-images\image-20200306155002037.png" alt="image-20200306155002037" style="zoom:67%;" />

最佳入场点在哪里？

不要犯“未来函数”的错误

### 四 机会在哪里？

#### 1 捕获趋势反转的关键点

#### 2 止损还是盈利突出，都要忍受煎熬，最好交给机器去做

### 五 实践

#### 建立一个股票池

- 创建策略
- 因子选股
- 股票池
- 检验

#### 股票池+择时

- 择时逻辑：短期均线上穿长期均线，海龟交易法则等

- 买入信号：

- 卖出信号

- 再买入/卖出

- 仓位控制

#### 交易规则的细节处理

- 买入、卖出信号
- 止盈止亏
- 仓位控制
- 指数调仓



### 基本逻辑

### 细节处理

### 策略检验

